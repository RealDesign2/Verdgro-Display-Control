

<!-- Pop up menus -->
<div id="popupMenuLocal" data-role="popup" data-theme="b">
        <ul style="min-width: 210px;" data-role="listview" data-theme="b" data-inset="true">            
            <li data-role="divider" data-theme="b"><span id="MenuLocalAction">Choose an action</span></li>
            <li><a href="#" onclick="LocalSendToShow();"><span id="MenuLocalToShow">Send to show</span></a></li>
			<li><a href="#" onclick="LocalSendToScreen();"><span id="MenuLocalToScreen">Send direct to screen</span></a></li>
			<li><a href="#" onclick="LocalDelete();"><span id="MenuLocalDelete">Delete</span></a></li>
            <li><a href="#" onclick="$('#popupMenuLocal').popup('close'); sClickedImageID='';"><span id="MenuLocalCancel">Cancel</span></a></li>            
        </ul>
</div>


<!-- /Pop up menus -->
<div id="ControllerOK"> 
	<div id="tabs" data-role="tabs">
	  <div class="ui-grid-a">
		<div class="ui-block-a"><a href="#" class="ui-shadow ui-btn ui-corner-all" onClick="switchTab('tabOne');"><span id="DirectTabStatus">Status</span></a></div>
		<div class="ui-block-b"><a href="#" class="ui-shadow ui-btn ui-corner-all" onClick="switchTab('tabTwo');"><span id="DirectTabEditShow">Edit Show</span></a></div>    
	</div>
	  <div class="ui-body-d ui-content" id="tabOne">    
		
		<div data-role="collapsible" data-collapsed="false">
			<h3><span id="DirectCurrentShow">Current Show</span></h3>
			<button type="button" data-icon="carat-r"   data-iconpos="left" data-mini="true" data-inline="true" onClick="QSPlay();"><span id="DirectButtonPlay">Play</span></button>
			<button type="button" data-icon="forbidden" data-iconpos="left" data-mini="true" data-inline="true" onClick="QSPause();"><span id="DirectButtonPause">Pause</span></button>	
						
			<div id="touchScroller" style="overflow: auto; overflow-y: hidden; height:235px; width:100%" >
			</div>
			
			<!--<button type="button" data-icon="refresh" data-iconpos="left" data-mini="true" data-inline="true" onClick="loadURL('internal/direct.html');" id="cmdRefresh"><span id="DirectButtonRefresh">Refresh</span></button>-->	
			<button type="button" data-icon="refresh" data-iconpos="left" data-mini="true" data-inline="true" onClick="GetCurrentShow();" id="cmdRefresh"><span id="DirectButtonRefresh">Refresh</span></button>	
			<!--
			<button type="button" data-icon="edit" data-iconpos="left" data-mini="true" data-inline="true" onClick="confirm('Are you sure? \nThe current show will be overwritten.');"><span id="DirectButtonEditShow">Edit this show</span></button>	
			-->
		</div>
		
		<div data-role="collapsible" >
			<h3><span id="DirectController">Controller</span></h3>
			<table>
				<tr>
					<td><b><span id="StatusBrightnessMode">Brightness mode</span></b></td>
					<td><span id="ControllerBrightnessMode">-</span></td>
				</tr>
				<tr>
					<td><b><span id="StatusBrightnessValue">Brightness value</span></b></td>
					<td><span id="ControllerBrightnessValue">-</span></td>
				</tr>
				<!--
				<tr>
					<td><b>Freeze</b></td>
					<td><span id="ControllerFreeze">-</span></td>
				</tr>
				-->
				<tr>
					<td><b><span id="StatusPowermode">Powermode / Pause</span></b></td>
					<td><span id="ControllerPowerState">-</span></td>
				</tr>
			</table>				
		</div>
		
		<div data-role="collapsible" >
			<h3><span id="DirectDisplay">Display</span></h3>
			<table>
				<tr>
					<td><b><span id="StatusDisplayName">Name</span></b></td>
					<td><span id="StatusDisplayNameValue">Getting...</span></td>
				</tr>
				<tr>
					<td><b><span id="StatusDisplayScreensize">Screensize (w x h)</span></b></td>
					<td><span id="StatusDisplayScreensizeValue">Getting...</span></td>
				</tr>
				<tr>
					<td><b><span id="StatusDisplayPixeldetection">Pixeldetection</span></b></td>
					<td>Not supported</td>
				</tr>			
			</table>			
		</div>
		
		<div data-role="collapsible" >
			<h3><span id="DirectAdvancedSettings">Advanced settings</span></h3>
			<table>
				<tr>
					<td><b><span id="StatusAdvancedSettingsUSB">USB Port</span></b></td>
					<td><span id="StatusAdvancedSettingsUSBValue">Getting...</span></td>
				</tr>
				<tr>
					<td><b><span id="StatusAdvancedSettingsOffset">Getting... (x , y)</span></b></td>
					<td><span id="StatusAdvancedSettingsOffsetValue">Getting...</span></td>
				</tr>
				<tr>
					<td><b><span id="StatusAdvancedSettingsProtocol">Protocol version</span></b></td>
					<td><span id="StatusAdvancedSettingsProtocolValue">Getting...</span></td>
				</tr>			
			</table>			
		</div>
		
	  </div>
	  
	  <!-- tabTwo -->
	  <div class="ui-body-d ui-content" id="tabTwo">
		<!-- Accordion -->
		<div id="colShow" data-role="collapsible" data-collapsed="false">
			<h3>Show editor</h3>
			<div id="touchScroller2" style="overflow: auto; overflow-y: hidden; height:275px; width:100%" >
				<br><br>Your show is empty<br><br>
			</div>
			<button type="button" data-icon="action" data-iconpos="left" data-mini="true" data-inline="true" onClick="SendShow();"><span id="ShowButtonSendShow">Send show to display and play</span></button>
			<button type="button" data-icon="action" data-iconpos="left" data-mini="true" data-inline="true" onClick="ClearShow();"><span id="ShowButtonClearShow">Clear complete show</span></button>
		</div>
		<div data-role="collapsible" data-collapsed="false">
			<h3><span id="TabLocal">Library (local)</span></h3>
			<div id="LibraryContainer"></div>
		</div>
		<div data-role="collapsible" data-collapsed="false">
			<h3><span id="TabEditText">Edit tekst image</span></h3>
			<center>
				<canvas id="cvText" width="80" height="80" style="border:1px solid #d3d3d3; background-color:#000000;"></canvas>
				<br>
				<button type="button" data-icon="carat-l" data-iconpos="notext"data-iconpos="left" data-mini="false" data-inline="true" onClick=""><span id="EditTextButtonSendShow"></span></button>
				Line : X &nbsp;
				<button type="button" data-icon="carat-r" data-iconpos="notext" data-iconpos="left" data-mini="false" data-inline="true" onClick=""><span id="EditTextButtonSendShow"></span></button>
				<br>
				<input type="text">
				<select>
					<option value="#ff0000">Red</option>
					<option value="#00ff00">Green</option>
					<option value="#0000ff">Blue</option>					
				</select>
				<select>
					<option value="8px">Size 8</option>
					<option value="9px">Size 9</option>
					<option value="10px">Size 10</option>
					<option value="11px">Size 11</option>
					<option value="12px">Size 12</option>
					<option value="14px">Size 14</option>
					<option value="16px">Size 16</option>
					<option value="18px">Size 18</option>
					<option value="20px">Size 20</option>
					<option value="24px">Size 24</option>
					<option value="28px">Size 28</option>
					<option value="32px">Size 32</option>
					<option value="38px">Size 38</option>
					<option value="44px">Size 44</option>					
				</select>
				
			</center>
		</div>
	  </div>
	</div>
</div>

<div id="ControllerError">
	<center>
		<br/><br/><br/>
		<span id="ControllerErrorText"></span>
	</center>
</div>


<script>
	//Layout
	//eerste tab selecteren (#TODO)
	$("#tabOne").addClass('ui-btn-active');
	$("#idpage").page();
	
		
	
	//Knoppen
	$("#btnBack").show();	
	$("#btnHome").show();

	//Vertaling instellen.	
	$("#LibraryTitle").html(jLang.LibraryTitle);
	$("#TabLocal").html(jLang.LibraryTabLocal);
	$("#TabPortal").html(jLang.LibraryTabPortal);
	$("#MenuPortalAction").html(jLang.LibraryMenuPortalAction);
	$("#MenuPortalToLocalLibrary").html(jLang.LibraryMenuPortalToLocalLibrary);
	$("#MenuPortalCancel").html(jLang.Cancel);
	$("#MenuLocalAction").html(jLang.LibraryMenuLocalAction);
	$("#MenuLocalToShow").html(jLang.LibraryMenuLocalToShow);
	$("#MenuLocalToScreen").html(jLang.LibraryMenuLocalToScreen);
	$("#MenuLocalDelete").html(jLang.Delete);
	$("#MenuLocalCancel").html(jLang.Cancel);
	$("#ButtonRefresh").html(jLang.Refresh);
	$("#DirectTabEditShow").html(jLang.DirectTabEditShow);
	$("#DirectTabStatus").html(jLang.DirectTabStatus);		
	$("#DirectCurrentShow").html(jLang.DirectCurrentShow);	
	$("#DirectButtonPlay").html(jLang.DirectButtonPlay);	
	$("#DirectButtonPause").html(jLang.DirectButtonPause);	
	$("#DirectNoCurrentShow").html(jLang.DirectNoCurrentShow);	
	$("#DirectButtonRefresh").html(jLang.Refresh);	
	$("#DirectButtonEditShow").html(jLang.DirectButtonEditShow);
	$("#DirectController").html(jLang.DirectController);
	$("#DirectDisplay").html(jLang.DirectDisplay);	
	
	$("#StatusBrightnessMode").html(jLang.StatusBrightnessMode);
	$("#StatusBrightnessValue").html(jLang.StatusBrightnessValue);
	$("#StatusPowermode").html(jLang.StatusPowermode);
	$("#StatusControllerButtonRefresh").html(jLang.Refresh);
	$("#StatusDisplayName").html(jLang.StatusDisplayName);
	$("#StatusDisplayScreensize").html(jLang.StatusDisplayScreensize);
	$("#StatusDisplayPixeldetection").html(jLang.StatusDisplayPixeldetection);
	$("#StatusShowButtonRefresh").html(jLang.Refresh);
	
	$("#ShowButtonSendShow").html(jLang.ShowButtonSendShow);
	$("#ShowButtonClearShow").html(jLang.ShowButtonClearShow);
	
	//=================================================================================
	var sClickedImageID = "";
	var sUser = "";
	
	
	
	$("#ControllerOK").hide();
	$("#ControllerError").show();
	$("#ControllerErrorText").html(jLang.DirectTextCheckingController);
	
	
	
	//Testen of connecite wel goed werkt.
	$.ajax(
		{
			url: GetURL('Login'),
            encoding: 'UTF-8',
			type: "POST",			
			timeout: AjaxControllerTimeout,
			async: true,
			//crossDomain: true,
			cache: false
		})
		.done(function( data ) {
			//alert('OK');
			//Alles is goed gegaan, Raspberry is te benaderen.
			//overige functies uitvoeren.
			//Ophalen van de naam van het display, indien deze anders is dan zorgen dat gegevens helemaal opnieuw worden ingelezen.
			var sPlayerName = DirectControllerInfo.VerdegroDisplayName
			PlayerGetVerdegroInfo(DirectControllerInfo)
			if (DirectControllerInfo.VerdegroDisplayName != sPlayerName) {
				//we hebben te maken met een nieuw scherm
				DirectControllerInfo.DataCollected = false  //zorgt ervoor dat het allemaal opnieuw wordt ingelezen.
				DirectShowTab = 'tabOne'					//zorgt ervoor dat we altijd naar de eerste tab gaan. 
			}
			if (DirectShowTab == 'tabOne') {
				switchTab('tabOne');
			} else {
				switchTab('tabTwo');
			}
			
			GetLibrary();									//Lokale library inlezen
			//Alleen de eerste keer automatisch gegevens inlezen, daarna altijd via refresh 
			if (DirectControllerInfo.DataCollected == false) {
				GetCurrentControllerStatus();				//Status controller en player ophalen en wegzetten.
				GetCurrentShow();							//Huidige show ophalen
				DirectControllerInfo.DataCollected = true;				
			} else {
				//we hebben de gegevens al, deze in beeld zetten.
				WriteCurrentShow()
				WriteCurrentController()
			} 
			
			WriteShow();					//Te editen show in beeld zetten.
			
			//Juiste gegevens in beeld zetten.
			$( "#set" ).children( ":last" ).collapsible( "collapse" );
			$("#ControllerOK").show();
			$("#ControllerError").hide();			
		})		
		.fail(function( jqXHR, textStatus ) {	
			if (IsDebug == true) {
				alert("AjaxError : \n" + textStatus + "\n" + jqXHR.statusText + "\n" + jqXHR.responseText);
			} else {
				alert("Error or Time-out");
			}
			$("#ControllerOK").hide();
			$("#ControllerErrorText").show();
			$("#ControllerErrorText").html(jLang.DirectTextTimeOutOrError);
		}
	);	
	
	
	
	//=================================================================================
	
	function switchTab(sTab) {
		$("#tabOne").hide();
		$("#tabTwo").hide();
		$("#" + sTab).show();
		DirectShowTab = sTab;
	} 
		
	//Toont Interne Bibliotheek
	function GetLibrary() {
		var sResult = ""
		//$("#LibraryContainer").html(appSettings.Library.length)
		if (appSettings.Library.length == 0) {
			sResult = "<br>" + jLang.LibraryNoItems + "<br><br>"
		} else {
			for (var i=0;i<appSettings.Library.length;i++)
			{ 
				sResult = sResult + "<img src='" + appSettings.Library[i].base64 + "' style='width:80px;' alt='" + appSettings.Library[i].filename + "'onClick='LocalImageClick(this);'  id='imglocal" + i + "'>&nbsp;&nbsp;"
			}
		} 
		$("#LibraryContainer").html(sResult);
	} 
	
	function PortalImageClick(objElement) {
		//alert(objElement.id);
		sClickedImageID = objElement.id;
		var p = $("#" + objElement.id); 
		$( "#popupMenu" ).popup("open", {positionTo: '#' + objElement.id });
	}
	
	function LocalSendToShow() {
		if (appSettings.Slide.length < ShowDefaultSlideMax) {
			//Toevoegen van afbeelding aan de showedit
			var sId = sClickedImageID;
			sId = sId.replace("imglocal", "")		
			
			oDia = {	"filename" 		: appSettings.Library[parseInt(sId)].filename,
						"base64" 		: appSettings.Library[parseInt(sId)].base64,
						"duration"		: 5}
						
			//slide toevoegen
			appSettings.Slide.push(oDia);
			//show opslaan
			window.localStorage.appSettings = JSON.stringify(appSettings);
			//verversen van show.
			WriteShow(true);		
			$('#popupMenuLocal').popup('close');
		} else {
			alert(jLang.ShowMaxItemsReached);
		} 
	} 
	
	function LocalSendToScreen() {
		if (confirm(jLang.LibraryConfirmToSreen) == true) {			
			var sId = sClickedImageID;
			sId = sId.replace("imglocal", "")			
			sB64 = appSettings.Library[parseInt(sId)].base64;
			//mimetype eraf halen
			//sB64 = sB64.substring(sB64.indexOf(",")+1).toLowerCase();
			//Nieuwe show aanmaken
			var jShow = { "Slide" : [ { "filename" : "", "base64" : "", "duration" : ShowDefaultSlideTime}]}
			jShow.Slide[0].filename = appSettings.Library[parseInt(sId)].filename;
			jShow.Slide[0].base64 = sB64;
			var oResult = QSSendShow(jShow);
			if (oResult.OK == "true") {
				alert(jLang.LibraryShowSendedDirectly);
				//navigator.notification.alert(jLang.LibraryShowSendedDirectly, null, AlertTitle, 'OK');
				//goed gegaan, show verversen
				GetCurrentShow();
			} else {
				if (IsDebug==true) {
					//gedeatileerde fout
					alert("Result LocalSendToScreen : " + oResult.data);
				} else {
					alert(jLang.LibraryShowSendedDirectlyError);
					//navigator.notification.alert(jLang.LibraryShowSendedDirectlyError, null, AlertTitle, 'OK');	
				}
			}
			
		} 
		$('#popupMenuLocal').popup('close');
	}
	
	function LocalDelete() {
		if (confirm(jLang.LibraryConfirmDelete) == true) {
			var sId = sClickedImageID;
			sId = sId.replace("imglocal", "")			
			//alert(sId);
			appSettings.Library.splice(parseInt(sId),1);
			//opslaan
			window.localStorage.appSettings = JSON.stringify(appSettings);	
			GetLibrary();
		} 
		$('#popupMenuLocal').popup('close');
	} 
	
	
	function LocalImageClick(objElement) {
		//alert(objElement.id);
		sClickedImageID = objElement.id;
		var p = $("#" + objElement.id); 
		$( "#popupMenuLocal" ).popup("open", {positionTo: '#' + objElement.id });
	}
	
	function PortalGetImage() {
		$('#popupMenu').popup('close');
		
		var sFile = $('#' + sClickedImageID).attr('src');
		var oImg = document.getElementById(sClickedImageID);	
		//toevoegen aan de library
		var jsonImage = { "filename": "", "base64" : ""} 
		jsonImage.filename = sFile.substring(sFile.lastIndexOf('/')+1);
		jsonImage.base64 = GetBase64FromImgObj(oImg)		
		appSettings.Library.push(jsonImage);
		//opslaan
		window.localStorage.appSettings = JSON.stringify(appSettings);		
		GetLibrary();
		navigator.notification.alert(jLang.LibraryAddedToLibrary, null, AlertTitle, 'OK');		
	} 
	
	//Get Current Show
	function GetCurrentShow() {	
	
		var sURL = "";
		var sXML = "";
		//afhankelijk van type verbinding juiste URL opbouwen.	
		if (IsDirectConnect == true) {
			sURL = URLExternal.replace("<ip>", IPDirectConnect);		
		} else {
			sURL = URLExternal.replace("<ip>", "SomeIP");
		} 	
		sURL = sURL + 'Publish/PlayList.xml'
		//alert(sURL)
		//Indien het fout gaat ook een melding van geven.
		$.ajax(
			{
				url: sURL,
				encoding: "UTF-8",
				//type: "POST",
				type: "GET",
				timeout: AjaxControllerTimeout,
				data: {},
				async: false,
				dataType: 'text',
				//crossDomain: true,
				cache: false
			})
			.done(function( data ) {
				//alert(data);
				//alert($(data).find("root"));
				var jXML = $.xml2json(data, true);
				
				//alert(jXML.item.length);
				//navigator.notification.alert(jXML.item.length, null, AlertTitle, 'OK');
				DirectControllerInfo.Slide = [];				//Resetten van het array van plaatjes				
				if (IsDirectConnect == true) {
					sURL = URLExternal.replace("<ip>", IPDirectConnect);		
				} else {
					sURL = URLExternal.replace("<ip>", "SomeIP");
				} 	
				for (var i=0;i<jXML.item.length;i++) {
					oDia = {	"path"			:  sURL + "Publish/",
								"filename" 		: jXML.item[i].fileName,								
								"duration"		: jXML.item[i].duration,
								"base64"		: ""
					}
						
					//slide toevoegen
					DirectControllerInfo.Slide.push(oDia);
					
				}
				WriteCurrentShow()
				//alert(jXML.root);
			})		
			.fail(function( jqXHR, textStatus ) {	
				alert(jLang.DirectErrorGettingPlaylist);	
			}
		);		
	} 
	
	function WriteCurrentShow() {
		//Zet de huidige show uit de player in beeld.
		//alert(DirectControllerInfo.Slide.length);
		var sHTML = "";	
		sHTML = sHTML + '<nobr>'		
		for (var i=0;i<DirectControllerInfo.Slide.length;i++) {
			sHTML = sHTML + '<div style="border:1px solid #000000; width:200px; height:200px; margin:4px; padding:4px; vertical-align: middle; text-align:center; display: inline-block; border-radius: 0.9em;"> ';
			//sHTML = sHTML + '<div style="width:200px; height:200px; display: inline-block; vertical-align: middle; border:1px solid #000000; text-align:center;">'
			sHTML = sHTML + '	<b>' + (i+1) + '.</b><br> ';
			sHTML = sHTML + '	Time : ' + DirectControllerInfo.Slide[i].duration + ' sec<br>	';
			if (DirectControllerInfo.Slide[i].base64 != "") {
				sHTML = sHTML + '	<div><img src="' + DirectControllerInfo.Slide[i].base64 + '" id="CurrentShowSlide' + i + '" onLoad="CurrentShowImageTobase64(this);" style="max-width: 140px; max-height: 140px;"><br></div> ';
			} else {	
			//	//alert("OK")
				sHTML = sHTML + '	<div><img src="' + DirectControllerInfo.Slide[i].path + DirectControllerInfo.Slide[i].filename + '" id="CurrentShowSlide' + i + '" onLoad="CurrentShowImageTobase64(this);" style="max-width: 140px; max-height: 140px;"><br></div> ';
			}			
			sHTML = sHTML + '</div> ';
			//alert("OK");						
		}	
		sHTML = sHTML + '</nobr>'	
		$("#touchScroller").html(sHTML);
		$("#touchScroller").trigger("create")		
	} 
	
	
	
	function CurrentShowImageTobase64(oImg)
	{	//id bepalen van array, uit naam van id object
		sID = oImg.id.replace('CurrentShowSlide', '');
		if (DirectControllerInfo.Slide[parseInt(sID)].base64 == "") {			
			DirectControllerInfo.Slide[parseInt(sID)].base64 = GetBase64FromImgObj(oImg)			
			//alert("OK - " + sID); 
		}
	} 
	
	
	function GetCurrentControllerStatus() {
		$("#ControllerOK").hide();
		$("#ControllerError").show();
		$("#ControllerErrorText").html(jLang.DirectTextCheckingController);
		//navigator.notification.alert('test', null, AlertTitle, 'OK');
		var oReturn;
		oReturn = ControllerGetBrightness();
		if (oReturn.OK == "true") {			
			DirectControllerInfo.ControllerBrightnessMode = oReturn.data.type
			DirectControllerInfo.ControllerBrightnessValue = oReturn.data.value			
			oReturn = ControllerGetPowerState();
			if (oReturn.OK == "true") {					
				DirectControllerInfo.ControllerPowerMode = oReturn.data
				//We hebben de Brithtness ingelezen. Nu info uit de XML bestanden inlezen.
				PlayerGetScreenInfo(DirectControllerInfo);			
				PlayerGetVerdegroInfo(DirectControllerInfo);
			} else {
				//navigator.notification.alert(oReturn.Data, null, AlertTitle +  ' - ERROR', 'OK');
				alert(oReturn.Data);
			}			
		} else {
			//navigator.notification.alert(oReturn.Data, null, AlertTitle +  ' - ERROR', 'OK');
			alert(oReturn.Data);
		} 
		WriteCurrentController();
		$( "#set" ).children( ":last" ).collapsible( "collapse" );
		$("#ControllerOK").show();
		$("#ControllerError").hide();	
	} 
	
	//zet de gegevens over de controller in beeld
	function WriteCurrentController() {
		$("#ControllerBrightnessMode").html(DirectControllerInfo.ControllerBrightnessMode);
		$("#ControllerBrightnessValue").html(((100/256) * parseInt(DirectControllerInfo.ControllerBrightnessValue)) + '%');	
		$("#ControllerPowerState").html(DirectControllerInfo.ControllerPowerMode);
		
		$("#StatusDisplayNameValue").html(DirectControllerInfo.VerdegroDisplayName);
		$("#StatusDisplayScreensizeValue").html(DirectControllerInfo.DisplaySizeWidth + " x " + DirectControllerInfo.DisplaySizeHeight);
		$("#StatusAdvancedSettingsUSBValue").html(DirectControllerInfo.ControllerUSBPort);
		$("#StatusAdvancedSettingsOffsetValue").html(DirectControllerInfo.DisplayOffsetX + "," + DirectControllerInfo.DisplayOffsetY);
		$("#StatusAdvancedSettingsProtocolValue").html(DirectControllerInfo.VerdegroProtocolVersion);
		
	} 
	
	function WriteShow(refresh) {
		//deze functie vult de huidige te editen show.
		var sHTML = "";
		
		if (appSettings.Slide.length > 0 ) {
			sHTML = sHTML + '<nobr>'
			for (var i=0;i<appSettings.Slide.length;i++) {
				sHTML = sHTML + '<div style="border:1px solid #000000; width:200px; height:240px; margin:4px; padding:4px; text-align:center; vertical-align: middle; display: inline-block; border-radius: 0.9em;"> ';
				sHTML = sHTML + '	<b>' + (i+1) + '.</b><br> ';
				//sHTML = sHTML + '	<img src="data:image/' + GetMimeFromUrl(appSettings.Slide[i].filename) + ';base64,'+ appSettings.Slide[i].base64 + '" style="max-width: 140px; max-height: 140px;"><br> ';				
				sHTML = sHTML + '	<button type="button" data-icon="minus" data-iconpos="notext" data-mini="true" data-inline="true" onClick="SlideMin('+ i + ');" id="SlideTimeMin' + i + '"></button>'
				sHTML = sHTML + '	<span id="SlideSec' + i +'">' + appSettings.Slide[i].duration + '</span> sec &nbsp;';
				sHTML = sHTML + '	<button type="button" data-icon="plus" data-iconpos="notext" data-mini="true" data-inline="true" onClick="SlidePlus('+ i + ');" id="SlideTimePlus' + i + '"></button><br>'
				sHTML = sHTML + '	<img src="'+ appSettings.Slide[i].base64 + '" style="max-width: 150px; max-height: 130px;"><br> ';
				sHTML = sHTML + '   <button type="button" data-icon="delete" data-iconpos="notext" data-inline="true" onClick="DeleteSlide(' + i + ');"></button> ';
				sHTML = sHTML + '</div> ';
			}	
			sHTML = sHTML + '</nobr>'			
		} else {
			sHTML = '<div style="width:300px"><br><br>' + jLang.ShowNoShowAvailabe + '<br><br></div>'
		}
		
		$("#touchScroller2").html(sHTML);
		$("#touchScroller2").trigger("create")
	
	} 
	
	function ClearShow() {
		if (confirm(jLang.AreYouSure) == true) {
			appSettings.Slide = [];
			window.localStorage.appSettings = JSON.stringify(appSettings);
			WriteShow();
		} 
	} 
		
	function SendShow() {
		var oResult = QSSendShow(appSettings);
		if (oResult.OK == "true") {
			alert(jLang.LibraryShowSendedDirectly);
			//navigator.notification.alert(jLang.LibraryShowSendedDirectly, null, AlertTitle, 'OK');
			//goed gegaan, show verversen
			GetCurrentShow();
		} else {
			if (IsDebug==true) {
				//gedeatileerde fout
				alert("Result LocalSendToScreen : " + oResult.data);
			} else {
				alert(jLang.LibraryShowSendedDirectlyError);
				//navigator.notification.alert(jLang.LibraryShowSendedDirectlyError, null, AlertTitle, 'OK');	
			}
		}
	} 
	
	function SlideMin(index) {
		if (appSettings.Slide[parseInt(index)].duration > 1) {
			appSettings.Slide[parseInt(index)].duration = parseInt(appSettings.Slide[parseInt(index)].duration) - 1;		
			$("#SlideSec" + index).html(appSettings.Slide[parseInt(index)].duration);
			window.localStorage.appSettings = JSON.stringify(appSettings);
		}
	} 
	
	function SlidePlus(index) { 
		if (appSettings.Slide[parseInt(index)].duration < 300) {
			appSettings.Slide[parseInt(index)].duration = parseInt(appSettings.Slide[parseInt(index)].duration) + 1;		
			$("#SlideSec" + index).html(appSettings.Slide[parseInt(index)].duration);
			window.localStorage.appSettings = JSON.stringify(appSettings);
		}
	} 
	
	function DeleteSlide(slideNumber) {
		if (confirm(jLang.AreYouSure) == true) {
			appSettings.Slide.splice(parseInt(slideNumber), 1);
			window.localStorage.appSettings = JSON.stringify(appSettings);
			if (appSettings.Slide.lenth == 0) {
				WriteShow();
			} else { 
				WriteShow(true);
			} 
			
		} 
	
	}
	
</script>